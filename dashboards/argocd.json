{
  "annotations": {"list": []},
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [{"title": "Back to Overview", "type": "link", "url": "/d/infrastructure-overview"}],
  "liveNow": false,
  "panels": [
    {
      "datasource": {"type": "prometheus", "uid": "${DS_PROMETHEUS}"},
      "description": "Application health distribution",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}}},
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
      "id": 1,
      "options": {"displayLabels": ["name", "value"], "legend": {"displayMode": "table", "placement": "right", "values": ["value"]}, "pieType": "pie"},
      "targets": [{"expr": "count by (health_status) (argocd_app_info)", "legendFormat": "{{health_status}}", "refId": "A"}],
      "title": "Application Health Status",
      "type": "piechart"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${DS_PROMETHEUS}"},
      "description": "Application sync status",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}}},
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
      "id": 2,
      "options": {"displayLabels": ["name", "value"], "legend": {"displayMode": "table", "placement": "right", "values": ["value"]}, "pieType": "pie"},
      "targets": [{"expr": "count by (sync_status) (argocd_app_info)", "legendFormat": "{{sync_status}}", "refId": "A"}],
      "title": "Application Sync Status",
      "type": "piechart"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${DS_PROMETHEUS}"},
      "description": "Applications requiring attention",
      "fieldConfig": {"defaults": {"color": {"mode": "thresholds"}, "custom": {"align": "left"}, "thresholds": {"steps": [{"color": "green", "value": null}]}}},
      "gridPos": {"h": 12, "w": 24, "x": 0, "y": 8},
      "id": 3,
      "options": {"cellHeight": "sm", "showHeader": true},
      "targets": [{"expr": "argocd_app_info{sync_status!=\"Synced\"} OR argocd_app_info{health_status!=\"Healthy\"}", "format": "table", "instant": true, "refId": "A"}],
      "title": "Applications Needing Attention",
      "transformations": [{"id": "organize", "options": {"excludeByName": {"Time": true, "__name__": true, "instance": true, "job": true}, "renameByName": {"name": "Application", "namespace": "Namespace", "health_status": "Health", "sync_status": "Sync"}}}],
      "type": "table"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${DS_PROMETHEUS}"},
      "description": "Reconciliation time",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "unit": "s"}},
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 20},
      "id": 4,
      "options": {"legend": {"calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom"}},
      "targets": [{"expr": "rate(argocd_app_reconcile_sum[5m]) / rate(argocd_app_reconcile_count[5m])", "legendFormat": "{{namespace}}/{{name}}", "refId": "A"}],
      "title": "Reconciliation Duration",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${DS_PROMETHEUS}"},
      "description": "Sync operations per second",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "unit": "ops"}},
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 20},
      "id": 5,
      "options": {"legend": {"calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom"}},
      "targets": [{"expr": "rate(argocd_app_sync_total[5m])", "legendFormat": "Sync Operations", "refId": "A"}],
      "title": "Sync Operations Rate",
      "type": "timeseries"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": ["copperiq", "argocd", "gitops"],
  "templating": {"list": [{"name": "DS_PROMETHEUS", "type": "datasource", "query": "prometheus"}]},
  "time": {"from": "now-1h", "to": "now"},
  "timezone": "Europe/Amsterdam",
  "title": "ArgoCD",
  "uid": "argocd",
  "version": 1
}
